---
- hosts: all
  become: yes
  tasks:
    - name: Install build tools via apt
      ansible.builtin.apt:
        pkg:
          - build-essential
          - git
          - ruby
          - ruby-dev
        state: present

    - name: get rvm 1 of 4
      get_url:
        url: https://rvm.io/pkuczynski.asc
        dest: /tmp/temp.asc
    - name: get rvm 2 of 4
      command: "cat /tmp/rvm.asc | gpg2 --import - "
    - name: get rvm 3 of 4
      get_url:
        url: https://get.rvm.io
        dest: /tmp/temp.io
    - name: get rvm 4 of 4
      command: "cat /tmp/rvm.io | bash -s stable"

    - name: Install github-pages gem
      gem:
        name: github-pages
        state: present

    - name: Install bundler gem
      gem:
        name: bundler
        state: present

    - name: Install kramdown gem
      gem:
        name: kramdown
        state: present

    - name: Install kramdown-parser-gfm gem
      gem:
        name: kramdown-parser-gfm
        state: present

    - name: Install build tools via pip
      ansible.builtin.pip:
        name:
          - setuptools
          - wheel
          - pyyaml==5.3.1
          - requests
          - beautifulsoup4
          - git_root
          - pandas
          - html5lib
          - python-dateutil
          - lxml
          - favicons
    - name: Install R build requirements
      ansible.builtin.command: |
        Rscript renv/activate.R
        Rscript -e 'renv::restore()'